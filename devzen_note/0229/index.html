<!DOCTYPE html>
<html lang="en-us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
		<title>
				Notes for episode-0229 &middot; Gliush Notebook
		</title>
	
		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro">
	
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
	
		
		<link href="" rel="alternate" type="application/rss+xml" title="Gliush Notebook" />
	</head>
	

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Gliush Notebook</h2>
				</a>
				<ul>
    <li><a href="/about">About</a></li>
    <li><a href="/">Posts</a></li>
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
        <div class="post-title">Notes for episode-0229</div>
        <div class="post-line"></div>

		

		

<h1 id="it-s-time-to-move-on-from-two-phase-commit">Itâ€™s Time to Move on from Two Phase Commit</h1>

<p><a href="http://dbmsmusings.blogspot.com/2019/01/its-time-to-move-on-from-two-phase.html">http://dbmsmusings.blogspot.com/2019/01/its-time-to-move-on-from-two-phase.html</a></p>

<ul>
<li>2PC is used in industry &gt; 30yrs</li>
<li>Briefly, what is 2PC</li>
<li>2PC problems:

<ul>
<li>Blocking problem: coordinator fails before final decision. Wait until coordinator recovers. Work arounds reduce performance</li>
<li>Cloggage problem: until the end of second phase workers have to stop other conflicting transactions, and their conflicting transactions, etc</li>
</ul></li>
<li>To sum up 2PC problems: latency, throughput, scalability, availability</li>
<li>Conceptually, main 2PC problem: worker can abort after the work is done (1st phase).</li>
<li>We need to change how distributed systems are architected

<ul>
<li>A transaction may abort at any time for any reason</li>
<li>System shouldn&rsquo;t have freedom to abort transaction. Only logic within the transaction could abort</li>
</ul></li>
<li>Example:

<ul>
<li>Shard1: X = 42   Shard2: Y -= 1; if (Y &lt; 0) ABORT; Z = Y</li>
<li>Simplified to:</li>
<li>Shard1: if(remote_read(Y) &gt; 0) X = 42;    Shard2: if (Y &gt; 0) {Y -= 1; Z = Y}</li>
</ul></li>
<li>All conditions are known before -&gt; no need to abort -&gt; no need for transaction protocol

<ul>
<li>IMHO: Whaaat?? how to coordinate reading from remote hosts?? What if 2 concurrent transaction does Y-=1??</li>
</ul></li>
<li>2 types of abort:

<ul>
<li>Caused by the state of the data (solved above)</li>
<li>Caused by the system itself (solved below)</li>
</ul></li>
<li>IMHO:

<ul>
<li>I don&rsquo;t understand, how concurrent transaction is handled ( Y-=1, the question above)</li>
<li>We need some additional &ldquo;solver&rdquo; that&rsquo;ll change all the workers logic on the fly?</li>
<li>What if remote worker is not available or high latency? (We&rsquo;ll solve it later? eventual consistency?)</li>
<li>O(n^2), that author suggests solving by broadcasting all the values to all the workers -&gt; incoming queue -&gt; GC -&gt; HELL</li>
</ul></li>
</ul>


		
	</div>

	<div class="pagination">
		<a href="/devzen_note/0228/" class="left arrow">&#8592;</a>
		<a href="/devzen_note/0230/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2019-07-20 23:21:40.515497 &#43;0400 &#43;04 m=&#43;0.067387412">2019</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
